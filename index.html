<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Videy com</title>

  <!-- Monetag -->
  <meta name="monetag" content="b6bc39af4e98f0d1f77a66a482db1d73">

  <!-- FluidPlayer & Axios -->
  <script src="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #1e1e1e;
      color: #fff;
      text-align: center;
      padding: 20px;
      margin: 0;
    }
    h1 {
      color: #ffcc00;
      margin-bottom: 20px;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: #2c2c2c;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    video {
      width: 100%;
      max-width: 640px;
      border: 2px solid #444;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      margin-bottom: 20px;
    }
    .controls {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 10px;
    }
    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover { background-color: #45a049; }
    button.pause { background-color: #f44336; }
    button.pause:hover { background-color: #da190b; }
    .fullscreen-btn { background-color: #2196F3; }
    .fullscreen-btn:hover { background-color: #0b7dda; }
    p { color: #aaa; }
    video::-webkit-media-controls { display: none !important; }
    video::-webkit-media-controls-enclosure { display: none !important; }
  </style>
</head>
<body>
  <div class="container">
    <h1 id="video-title">Memuat Video...</h1>
    <video id="video-player" controls autoplay></video>
    <div class="controls">
      <button id="playBtn">Putar</button>
      <button id="pauseBtn" class="pause">Jeda</button>
      <button id="fullscreenBtn" class="fullscreen-btn">Full Screen</button>
    </div>
    <p id="video-desc">Silakan tunggu, video sedang dimuat dari database...</p>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      let videoId = "";

      // 1. Ambil dari query ?v=
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.has("v")) {
        videoId = urlParams.get("v");
      } else {
        // 2. Ambil dari path (contoh: /e/ID atau /ID)
        let pathParts = window.location.pathname.split("/");
        videoId = pathParts.pop() || pathParts.pop(); // ambil terakhir
      }

      const videoPlayer = document.getElementById('video-player');
      const playBtn = document.getElementById('playBtn');
      const pauseBtn = document.getElementById('pauseBtn');
      const fullscreenBtn = document.getElementById('fullscreenBtn');
      const videoTitle = document.getElementById('video-title');
      const videoDesc = document.getElementById('video-desc');

      if (!videoId) {
        videoTitle.textContent = "ID video tidak ditemukan";
        videoPlayer.src = '';
        return;
      }

      try {
        // âœ… pastikan link raw JSON benar
        const response = await axios.get('https://raw.githubusercontent.com/DoodstreamPro/_e/main/Video.json');
        const videos = response.data;

        const foundVideo = videos.find(video => video.id === videoId);

        if (foundVideo) {
          videoPlayer.src = foundVideo.Url;
          videoTitle.textContent = foundVideo.Judul;
          videoDesc.textContent = "Video berhasil dimuat.";

          if (foundVideo.PosterUrl) {
            videoPlayer.setAttribute('poster', foundVideo.PosterUrl);
          }

          // Aktifkan FluidPlayer
          const fluidInstance = fluidPlayer(
            'video-player',
            {
              layoutControls: {
                controlBar: {
                  autoHideTimeout: 3,
                  animated: true,
                  autoHide: true,
                  fullscreen: true,
                  playPause: true,
                  progress: true,
                  volume: true,
                  playbackRates: true,
                  theatreMode: true,
                  download: false
                },
                autoPlay: false,
                mute: false,
                allowTheatre: true,
                playPauseAnimation: true,
                playbackRateEnabled: true,
                allowDownload: false,
                playButtonShowing: true,
                fillToContainer: true,
                posterImage: foundVideo.PosterUrl || ""
              }
            }
          );

          // Tombol manual
          playBtn.addEventListener('click', () => fluidInstance.play());
          pauseBtn.addEventListener('click', () => fluidInstance.pause());
          fullscreenBtn.addEventListener('click', () => {
            if (videoPlayer.requestFullscreen) {
              videoPlayer.requestFullscreen();
            } else if (videoPlayer.webkitRequestFullscreen) {
              videoPlayer.webkitRequestFullscreen();
            }
          });
        } else {
          videoTitle.textContent = "Video tidak ditemukan";
          videoDesc.textContent = "Periksa kembali ID video.";
          videoPlayer.src = '';
        }
      } catch (error) {
        videoTitle.textContent = "Error memuat video";
        videoDesc.textContent = "Gagal mengambil data JSON.";
        videoPlayer.src = '';
      }
    });
  </script>
</body>
</html>